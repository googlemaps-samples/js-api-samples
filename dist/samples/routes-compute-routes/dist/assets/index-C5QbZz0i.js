(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))p(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&p(d)}).observe(document,{childList:!0,subtree:!0});function m(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function p(l){if(l.ep)return;l.ep=!0;const c=m(l);fetch(l.href,c)}})();/*
 * @license
 * Copyright 2025 Google LLC. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */let g=[],f=[];const L={predictionText:null,location:null},v={predictionText:null,location:null};async function P(){const[{InfoWindow:h},{AdvancedMarkerElement:u},{PlaceAutocompleteElement:m},{ComputeRoutesExtraComputation:p,ReferenceRoute:l,Route:c,RouteLabel:d}]=await Promise.all([google.maps.importLibrary("maps"),google.maps.importLibrary("marker"),google.maps.importLibrary("places"),google.maps.importLibrary("routes")]),a=document.getElementById("map");T(),M(),b(),N(),x(),F();function T(){const e=document.getElementById("compute-routes-form");e.addEventListener("submit",t=>{t.preventDefault(),_(new FormData(e))})}async function _(e){R();try{const{routes:t}=await c.computeRoutes(w(e));if(!t){console.log("No routes returned.");return}console.log("Routes:"),t.forEach(n=>{console.log(n.toJSON())}),await Promise.all(t.map(n=>A(n,!!n.routeLabels?.includes(d.DEFAULT_ROUTE))))}catch(t){console.error(t),I(t.message||"Unknown error.")}}function w(e){const t=e.get("travel_mode")===""?void 0:e.get("travel_mode"),n=[],i=[],s={},o={origin:{location:E(L,e.get("origin_location"),e.get("heading_org"),t),vehicleStopover:e.get("origin_stopover")==="on",sideOfRoad:e.get("origin_side_of_road")==="on"},destination:{location:E(v,e.get("destination_location"),e.get("heading_dest"),t),vehicleStopover:e.get("destination_stopover")==="on",sideOfRoad:e.get("destination_side_of_road")==="on"},fields:Array.from(document.querySelectorAll('ul#fields li input[type="checkbox"]:checked'),r=>r.value),travelMode:t,routingPreference:e.get("routing_preference")===""?void 0:e.get("routing_preference"),polylineQuality:e.get("polyline_quality")===""?void 0:e.get("polyline_quality"),computeAlternativeRoutes:e.get("compute_alternative_routes")==="on",routeModifiers:{avoidTolls:e.get("avoid_tolls")==="on",avoidHighways:e.get("avoid_highways")==="on",avoidFerries:e.get("avoid_ferries")==="on",avoidIndoor:e.get("avoid_indoor")==="on"},departureTime:e.get("departure_time")===""?void 0:new Date(e.get("departure_time")),extraComputations:n,requestedReferenceRoutes:i,transitPreference:s};if(e.get("traffic_aware_polyline")==="on"&&n.push(p.TRAFFIC_ON_POLYLINE),e.get("shorter_distance")==="on"&&i.push(l.SHORTER_DISTANCE),e.get("eco_routes")==="on"&&(i.push(l.FUEL_EFFICIENT),n.push(p.FUEL_CONSUMPTION),o.routeModifiers.vehicleInfo={emissionType:e.get("emission_type")}),t===google.maps.TravelMode.TRANSIT){const r=document.querySelectorAll('ul#transitModes li input[type="checkbox"]:checked');s.allowedTransitModes=Array.from(r,y=>y.value),s.routingPreference=e.get("transit_preference")===""?void 0:e.get("transit_preference")}return o}function E(e,t,n,i){if(!t)throw new Error("Location is required.");const s=/^-?\d+(\.\d+)?,\s*-?\d+(\.\d+)?$/,o=t,r=n&&i!=="TRANSIT"?Number(n):void 0;return e.predictionText===o&&e.location?{lat:e.location.lat(),lng:e.location.lng(),altitude:0,heading:r}:s.test(o)?{lat:Number(o.split(",")[0]),lng:Number(o.split(",")[1]),altitude:0,heading:r}:o}function I(e){const t=document.getElementById("alert");t.querySelector("p").textContent=e,t.style.display="flex"}async function A(e,t){f=f.concat(e.createPolylines({polylineOptions:t?{map:a.innerMap,zIndex:1}:{map:a.innerMap,strokeColor:"#669DF6",strokeOpacity:.5,strokeWeight:8},colorScheme:a.innerMap.get("colorScheme")})),t&&(g=g.concat(await e.createWaypointAdvancedMarkers({map:a.innerMap,zIndex:1})),e.viewport&&a.innerMap.fitBounds(e.viewport)),C(e,Math.floor(e.path.length/2))}function C(e,t){const n=document.createElement("div");if(n.className="route-tag",e.routeLabels&&e.routeLabels.length>0){const o=document.createElement("p");e.routeLabels.forEach((r,y)=>{r.includes(d.FUEL_EFFICIENT)&&n.classList.add("eco"),r.includes(d.DEFAULT_ROUTE_ALTERNATE)&&n.classList.add("alternate"),r.includes(d.SHORTER_DISTANCE)&&n.classList.add("shorter-distance"),o.appendChild(document.createTextNode(r)),y<e.routeLabels.length-1&&o.appendChild(document.createElement("br"))}),n.appendChild(o)}const i=document.createElement("div");if(i.className="details",e.localizedValues){const o=document.createElement("p");o.textContent=`Distance: ${e.localizedValues.distance}`,i.appendChild(o);const r=document.createElement("p");r.textContent=`Duration: ${e.localizedValues.duration}`,i.appendChild(r)}if(e.travelAdvisory?.fuelConsumptionMicroliters){const o=document.createElement("p");o.textContent=`Fuel consumption: ${(e.travelAdvisory.fuelConsumptionMicroliters/1e6).toFixed(2)} L`,i.appendChild(o)}n.appendChild(i);const s=new u({map:a.innerMap,position:e.path[t],content:n,zIndex:e.routeLabels?.includes(d.DEFAULT_ROUTE)?1:void 0});g.push(s)}function R(){g.forEach(e=>{e.map=null}),g.length=0,f.forEach(e=>{e.setMap(null)}),f.length=0}function b(){if(!a||!a.innerMap)return;let e=document.getElementById("infowindow-alert");e||(e=document.createElement("div"),e.id=e.className="infowindow-alert",e.textContent="Lat/Lng are copied to clipboard");const t=new h;let n;a.innerMap.addListener("click",async i=>{i.latLng&&(t.close(),n&&clearTimeout(n),t.setContent(e),t.setPosition({lat:i.latLng.lat(),lng:i.latLng.lng()}),await navigator.clipboard.writeText(`${i.latLng.lat()},${i.latLng.lng()}`),t.open(a.innerMap),n=window.setTimeout(()=>{t.close()},2e3))})}function N(){const e=document.getElementById("travel-mode"),t=document.getElementById("routing-preference"),n=document.getElementById("traffic-aware-polyline"),i=document.getElementById("eco-routes"),s=document.getElementById("emission-type");e.addEventListener("change",()=>{e.value==="WALKING"||e.value==="BICYCLING"||e.value==="TRANSIT"?(t.disabled=!0,t.value=""):(t.disabled=!1,t.value=t.value||"TRAFFIC_UNAWARE"),o(),document.getElementById("transit-options").style.display=e.value==="TRANSIT"?"flex":"none"}),t.addEventListener("change",()=>{o()}),i.addEventListener("change",()=>{i.checked?s.disabled=!1:s.disabled=!0});function o(){!t.value||t.value==="TRAFFIC_UNAWARE"?(n.checked=!1,n.disabled=!0):n.disabled=!1}}function x(){const e=document.getElementById("alert");e.querySelector(".close").addEventListener("click",()=>{e.style.display!=="none"&&(e.style.display="none")})}function M(){const e=new m({name:"origin_location"}),t=new m({name:"destination_location"});[[e,L],[t,v]].forEach(([n,i])=>{n.addEventListener("gmp-select",async s=>{i.predictionText=s.placePrediction.text.text;const o=s.placePrediction.toPlace();await o.fetchFields({fields:["location"]}),i.location=o.location})}),document.getElementById("origin-input")?.appendChild(e),document.getElementById("destination-input")?.appendChild(t)}function F(){const e=document.getElementById("departure-time"),t=document.getElementById("utc-output");e.addEventListener("change",()=>{t.textContent=`UTC time: ${new Date(e.value).toUTCString()}`})}}window.addEventListener("load",P);
